<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Mariem‚Äôs 12-Week Glow-Up Tracker ‚ú®</title>

<!-- PWA manifest and theme color -->
<link rel="manifest" href="manifest.json" />
<meta name="theme-color" content="#5a2a57" />

<style>
  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap');
  body {
    font-family: 'Poppins', sans-serif;
    background: #fff0f6;
    color: #5a2a57;
    margin: 0; padding: 0;
    display: flex; flex-direction: column; align-items: center;
    min-height: 100vh;
    line-height: 1.5;
  }
  header {
    padding: 20px 10px;
    font-weight: 600;
    font-size: 1.8rem;
    text-align: center;
    letter-spacing: 0.05em;
  }
  .week-container {
    width: 95vw; max-width: 400px;
    background: linear-gradient(135deg, #fce4f2 0%, #f9d5e5 100%);
    margin-bottom: 15px;
    border-radius: 15px;
    box-shadow: 0 6px 12px rgba(90, 42, 87, 0.3);
    padding: 15px;
    display: flex; flex-direction: column; align-items: center;
    transition: box-shadow 0.3s ease, transform 0.3s ease;
  }
  .week-container:hover {
    box-shadow: 0 10px 20px rgba(90, 42, 87, 0.4);
    transform: translateY(-5px);
  }
  .week-title {
    font-weight: 600;
    font-size: 1.2rem;
    margin-bottom: 10px;
    text-align: center;
  }
  input[type="file"] {
    display: none;
  }
  label.upload-btn {
    background: #b85c9e;
    color: white;
    padding: 10px 20px;
    border-radius: 30px;
    cursor: pointer;
    user-select: none;
    margin-bottom: 10px;
    transition: background 0.3s ease, box-shadow 0.3s ease;
    letter-spacing: 0.05em;
  }
  label.upload-btn:hover,
  label.upload-btn:focus {
    background: #91397d;
    box-shadow: 0 0 8px 2px #b85c9e99;
    outline: none;
  }
  .save-week-btn {
    margin-left: 10px;
    background: #7a378b;
    color: white;
    border: none;
    padding: 6px 14px;
    border-radius: 20px;
    cursor: pointer;
    font-size: 0.9rem;
    transition: background 0.3s ease, box-shadow 0.3s ease;
    letter-spacing: 0.05em;
  }
  .save-week-btn:hover,
  .save-week-btn:focus {
    background: #5a2a57;
    box-shadow: 0 0 8px 2px #5a2a5799;
    outline: none;
  }
  img.preview {
    max-width: 100%;
    max-height: 250px;
    border-radius: 15px;
    box-shadow: 0 4px 10px rgba(90, 42, 87, 0.2);
    margin-bottom: 10px;
    object-fit: cover;
    opacity: 0;
    transition: opacity 0.5s ease;
  }
  img.preview[src]:not([src=""]) {
    opacity: 1;
  }
  textarea.quote {
    width: 100%;
    resize: none;
    border-radius: 10px;
    border: 1px solid #b85c9e;
    padding: 8px;
    font-size: 1rem;
    font-family: 'Poppins', sans-serif;
    color: #5a2a57;
    background: #fff0f6;
    transition: box-shadow 0.3s ease;
  }
  textarea.quote:focus {
    outline: none;
    box-shadow: 0 0 8px 2px #b85c9e99;
    border-color: #b85c9e;
  }
  .weight-input-container {
    margin-top: 8px;
    width: 100%;
    display: flex;
    align-items: center;
    gap: 6px;
  }
  .weight-input-container label {
    font-weight: 600;
    color: #5a2a57;
    min-width: 80px;
  }
  .weight-input-container input[type="number"] {
    flex-grow: 1;
    padding: 6px;
    border-radius: 8px;
    border: 1px solid #b85c9e;
    background: #fff0f6;
    color: #5a2a57;
    font-size: 1rem;
    transition: box-shadow 0.3s ease;
  }
  .weight-input-container input[type="number"]:focus {
    outline: none;
    box-shadow: 0 0 8px 2px #b85c9e99;
    border-color: #b85c9e;
  }
  .save-btn {
    background: #5a2a57;
    color: #fff0f6;
    padding: 12px 25px;
    font-weight: 600;
    border: none;
    border-radius: 30px;
    cursor: pointer;
    margin: 20px 0 40px;
    transition: background 0.3s ease, box-shadow 0.3s ease;
    position: sticky;
    bottom: 10px;
    z-index: 10;
    letter-spacing: 0.05em;
  }
  .save-btn:hover,
  .save-btn:focus {
    background: #7d4977;
    box-shadow: 0 0 8px 2px #7d497799;
    outline: none;
  }
  footer {
    text-align: center;
    padding: 10px 5px;
    font-size: 0.9rem;
    color: #5a2a57aa;
  }
  .upload-row {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    margin-bottom: 10px;
    flex-wrap: wrap;
  }
</style>
</head>
<body>

<header>Mariem‚Äôs 12-Week Endolift Glow-Up Tracker ‚ú®</header>

<form id="trackerForm">
  <div id="weeksContainer"></div>

  <button type="button" class="save-btn" onclick="saveData()">Save All Progress üíæ</button>
</form>

<footer>Keep shining, Mariem! üíñ</footer>

<script>
  const weeksContainer = document.getElementById('weeksContainer');

  const defaultQuotes = [
    "Every change begins with courage ‚Äî your glow starts now.",
    "Renewed inside and out, your beauty is unfolding.",
    "Small steps, big transformation ‚Äî keep shining.",
    "Healing is your superpower; embrace the process.",
    "Strength grows through every challenge you overcome.",
    "Confidence blooms with each passing week.",
    "Radiate beauty from your soul to your skin.",
    "Your journey is a masterpiece in progress.",
    "Patience fuels the best transformations.",
    "Glow isn‚Äôt just skin deep ‚Äî it‚Äôs your spirit rising.",
    "Trust the process; your reflection will thank you.",
    "You are radiant, resilient, and unstoppable."
  ];

  function formatDate(date) {
    return date.toLocaleDateString(undefined, { day: 'numeric', month: 'short' });
  }

  function getWeekDateRange(startDate, weekNumber) {
    const start = new Date(startDate);
    start.setDate(start.getDate() + (weekNumber - 1) * 7);
    const end = new Date(start);
    end.setDate(end.getDate() + 6);
    return `${formatDate(start)} ‚Äì ${formatDate(end)}`;
  }

  for(let i=1; i<=12; i++) {
    const range = getWeekDateRange(new Date('2025-06-18'), i);
    const weekDiv = document.createElement('div');
    weekDiv.className = 'week-container';
    weekDiv.innerHTML = `
      <div class="week-title">Week ${i} (${range})</div>
      <div class="upload-row">
        <label class="upload-btn" for="photo${i}">Upload Photo üì∏</label>
        <input type="file" id="photo${i}" accept="image/*" onchange="previewImage(event, ${i})" />
        <button type="button" class="save-week-btn" onclick="saveWeek(${i})">Save This Week üíæ</button>
      </div>
      <img id="preview${i}" class="preview" src="" alt="No photo yet" style="display:none;" />
      <textarea class="quote" id="quote${i}" rows="2" placeholder="Write your motivational quote or use this:">${defaultQuotes[i-1]}</textarea>
      <div class="weight-input-container">
        <label for="weight${i}">Weight (kg):</label>
        <input type="number" id="weight${i}" min="20" max="300" step="0.1" />
      </div>
    `;
    weeksContainer.appendChild(weekDiv);
  }

  function previewImage(event, week) {
    const preview = document.getElementById('preview' + week);
    const file = event.target.files[0];
    if(file) {
      const reader = new FileReader();
      reader.onload = function(e) {
        preview.src = e.target.result;
        preview.style.display = 'block';
      }
      reader.readAsDataURL(file);
    } else {
      preview.src = '';
      preview.style.display = 'none';
    }
  }

  function saveWeek(week) {
    let data = JSON.parse(localStorage.getItem('mariemGlowUpData')) || [];

    const quoteInput = document.getElementById('quote' + week);
    const imgPreview = document.getElementById('preview' + week);
    const weightInput = document.getElementById('weight' + week);
    const imgSrc = imgPreview.src || '';
    const weightVal = weightInput.value.trim();

    const index = data.findIndex(d => d.week === week);
    const entry = { week: week, photo: imgSrc, quote: quoteInput.value, weight: weightVal };

    if (index > -1) data[index] = entry;
    else data.push(entry);

    localStorage.setItem('mariemGlowUpData', JSON.stringify(data));
    alert(`Week ${week} saved! üíæ`);
  }

  function saveData() {
    let data = [];
    for(let i=1; i<=12; i++) {
      const quoteInput = document.getElementById('quote' + i);
      const imgPreview = document.getElementById('preview' + i);
      const weightInput = document.getElementById('weight' + i);
      const imgSrc = imgPreview.src || '';
      const weightVal = weightInput.value.trim();

      data.push({
        week: i,
        photo: imgSrc,
        quote: quoteInput.value,
        weight: weightVal
      });
    }
    localStorage.setItem('mariemGlowUpData', JSON.stringify(data));
    alert('All progress saved! üíæ');
  }

  function loadData() {
    const saved = localStorage.getItem('mariemGlowUpData');
    if(saved) {
      const data = JSON.parse(saved);
      data.forEach(item => {
        if(item.photo) {
          const preview = document.getElementById('preview' + item.week);
          preview.src = item.photo;
          preview.style.display = 'block';
        }
        document.getElementById('quote' + item.week).value = item.quote || '';
        if(item.weight !== undefined) {
          document.getElementById('weight' + item.week).value = item.weight;
        }
      });
    }
  }

  loadData();

  // Daily motivational messages
  const dailyMessages = [
    "Wake Mariem, rise and shine! ‚òÄÔ∏è Ghassan loves you!",
    "Good morning, beautiful! Time to glow up! ‚ú®",
    "New day, new progress. Let‚Äôs do this, Mariem! üí™",
    "Smile, breathe, and sparkle today! üå∏",
    "Every day is a fresh start. You got this! üíñ",
    "Keep shining, queen! Your journey inspires. üëë",
    "Rise up, glow up, show up! üöÄ",
    "Hello sunshine! Let today be amazing. üåû",
    "You‚Äôre unstoppable, Mariem! Keep going! üî•",
    "Good vibes only ‚Äî let‚Äôs make today great! ‚ú®"
  ];

  // Show daily message once per day
  function showDailyMessage() {
    const lastShown = localStorage.getItem('lastMessageDate');
    const today = new Date().toDateString();

    if (lastShown !== today) {
      const msg = dailyMessages[Math.floor(Math.random() * dailyMessages.length)];
      alert(msg);
      localStorage.setItem('lastMessageDate', today);
    }
  }

  showDailyMessage();

</script>

<!-- Register service worker for offline caching and update notification -->
<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('service-worker.js').then(reg => {
      console.log('Service Worker registered');

      reg.addEventListener('updatefound', () => {
        const newWorker = reg.installing;
        newWorker.addEventListener('statechange', () => {
          if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
            if (confirm('‚ú® New version available! Refresh now to update your tracker?')) {
              window.location.reload();
            }
          }
        });
      });
    }).catch(err => {
      console.log('Service Worker registration failed:', err);
    });
  }
</script>

</body>
</html>
